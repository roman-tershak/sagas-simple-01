version: '2'

networks:
  vnet-saga-simple-1:

services:
  mariadb-service:
    image: mariadb:10.4
    container_name: mariadbsrv
    hostname: mariadbsrv
    networks:
      - vnet-saga-simple-1
    expose:
      - 3306
    environment:
      - MYSQL_ROOT_PASSWORD=htgrfedw
      - MYSQL_DATABASE=sagasimple1
      - MYSQL_USER=sagau
      - MYSQL_PASSWORD=sagahtgrfe
  activemq-service:
    image: rtershak/activemq:5.15.9
    container_name: activemqsrv
    hostname: activemqsrv
    networks:
      - vnet-saga-simple-1
  order-service:
    image: saga-tests-simple-1/order-service:1.0-SNAPSHOT
    container_name: order-service
    depends_on:
      - mariadb-service
      - activemq-service
    hostname: order-service
    networks:
      - vnet-saga-simple-1
    environment:
      - SPRING_DATASOURCE_URL=jdbc:mariadb://mariadbsrv:3306/sagasimple1
      - SPRING_DATASOURCE_USERNAME=sagau
      - SPRING_DATASOURCE_PASSWORD=sagahtgrfe
      - SPRING_ACTIVEMQ_BROKER_URL=tcp://activemqsrv:61616
  reservation-service:
    image: saga-tests-simple-1/reservation-service:1.0-SNAPSHOT
    container_name: reservation-service
    depends_on:
      - mariadb-service
      - activemq-service
    hostname: reservation-service
    networks:
      - vnet-saga-simple-1
    environment:
      - SPRING_DATASOURCE_URL=jdbc:mariadb://mariadbsrv:3306/sagasimple1
      - SPRING_DATASOURCE_USERNAME=sagau
      - SPRING_DATASOURCE_PASSWORD=sagahtgrfe
      - SPRING_ACTIVEMQ_BROKER_URL=tcp://activemqsrv:61616
  cart-service:
    image: saga-tests-simple-1/cart-service:1.0-SNAPSHOT
    container_name: cart-service
    depends_on:
      - mariadb-service
      - activemq-service
    hostname: cart-service
    networks:
      - vnet-saga-simple-1
    environment:
      - SPRING_DATASOURCE_URL=jdbc:mariadb://mariadbsrv:3306/sagasimple1
      - SPRING_DATASOURCE_USERNAME=sagau
      - SPRING_DATASOURCE_PASSWORD=sagahtgrfe
      - SPRING_ACTIVEMQ_BROKER_URL=tcp://activemqsrv:61616
